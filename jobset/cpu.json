{
  "apiVersion": "jobset.x-k8s.io/v1alpha2",
  "kind": "JobSet",
  "metadata": {
    "name": "cpu-unit-tests",
    "annotations": {
      "kueue.x-k8s.io/queue-name": "cpu-worker"
    }
  },
  "spec": {
    "failurePolicy": {
      "maxRestarts": INSERT_MAX_RESTARTS
    },
    "replicatedJobs": [
      {
        "name": "job",
        "replicas": 1,
        "template": {
          "spec": {
            "parallelism": 1,
            "completions": 1,
            "backoffLimit": 0,
            "template": {
              "metadata": {
                "annotations": {
                  "kubectl.kubernetes.io/default-container": "cpu-unit-tests"
                }
              },
              "spec": {
                "terminationGracePeriodSeconds": 60,
                "restartPolicy": "Never",
                "initContainers": [],
                "hostNetwork": true,
                "dnsPolicy": "ClusterFirstWithHostNet",
                "nodeSelector": {
                  "cloud.google.com/gke-nodepool": "worker-pool"
                },
                "containers": [
                  {
                    "name": "cpu-unit-tests",
                    "image": "INSERT_DOCKER_IMAGE",
                    "securityContext": {
                      "privileged": true
                    },
                    
                    "command": [
                      "bash",
                      "/var/arc/cpu-jobset-startup.sh"
                    ],
                    "resources": {
                      "requests": {
                        "cpu": "30",
                        "memory": "128Gi"
                      }
                    },
                    "env": [
                      {
                        "name": "NUM_PROCESSES",
                        "value": "1"
                      },
                      {
                        "name": "PROCESS_ID",
                        "valueFrom": {
                          "fieldRef": {
                            "fieldPath": "metadata.annotations['batch.kubernetes.io/job-completion-index']"
                          }
                        }
                      },
                      {
                        "name": "GCS_PREFIX",
                        "value": "INSERT_GCS_PREFIX"
                      },
                      {
                        "name": "CUSTOM_GIT_ORIGIN",
                        "value": "INSERT_GIT_ORIGIN"
                      },
                      {
                        "name": "CUSTOM_GIT_BRANCH",
                        "value": "INSERT_GIT_BRANCH"
                      },
                      {
                        "name": "GH_RUN_ID",
                        "value": "INSERT_GH_RUN_ID"
                      }
                    ]
                  }
                ],
                "serviceAccountName": "default"
              }
            }
          }
        }
      }
    ]
  }
}